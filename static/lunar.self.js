function LunarDate(e,t,n,r,i){this.day=e;this.month=t;this.year=n;this.leap=r;this.jd=i}function INT(e){return Math.floor(e)}function jdn(e,t,n){var r=INT((14-t)/12);var i=n+4800-r;var s=t+12*r-3;var o=e+INT((153*s+2)/5)+365*i+INT(i/4)-INT(i/100)+INT(i/400)-32045;return o}function jdn2date(e){var t,n,r,i,s,o,u,a,f,l,c;t=e;if(t<2299161){n=t}else{r=INT((t-1867216.25)/36524.25);n=t+1+r-INT(r/4)}i=n+1524;s=INT((i-122.1)/365.25);o=INT(365.25*s);u=INT((i-o)/30.6001);a=INT(i-o-INT(30.6001*u));if(u<14){f=u-1}else{f=u-13}if(f<3){l=s-4715}else{l=s-4716}return new Array(a,f,l)}function decodeLunarYear(e,t){var n,r,s,o,u,a,f,l,c;var h=new Array;n=new Array(29,30);r=new Array(12);s=t>>17;o=t&15;u=n[t>>16&1];a=jdn(1,1,e);f=a+s;l=t>>4;for(i=0;i<12;i++){r[12-i-1]=n[l&1];l>>=1}if(o==0){for(c=1;c<=12;c++){h.push(new LunarDate(1,c,e,0,f));f+=r[c-1]}}else{for(c=1;c<=o;c++){h.push(new LunarDate(1,c,e,0,f));f+=r[c-1]}h.push(new LunarDate(1,o,e,1,f));f+=u;for(c=o+1;c<=12;c++){h.push(new LunarDate(1,c,e,0,f));f+=r[c-1]}}return h}function getYearInfo(e){var t;if(e<1900){t=TK19[e-1800]}else if(e<2e3){t=TK20[e-1900]}else if(e<2100){t=TK21[e-2e3]}else{t=TK22[e-2100]}return decodeLunarYear(e,t)}function findLunarDate(e,t){if(e>LAST_DAY||e<FIRST_DAY||t[0].jd>e){return new LunarDate(0,0,0,0,e)}var n=t.length-1;while(e<t[n].jd){n--}var r=e-t[n].jd;ret=new LunarDate(t[n].day+r,t[n].month,t[n].year,t[n].leap,e);return ret}function getLunarDate(e,t,n){var r,i;if(n<1800||2199<n){}r=getYearInfo(n);i=jdn(e,t,n);if(i<r[0].jd){r=getYearInfo(n-1)}return findLunarDate(i,r)}function SunLongitude(e){var t,n,r,i,s,o,u,a,f;t=(e-2451545)/36525;n=t*t;r=PI/180;i=357.5291+35999.0503*t-1559e-7*n-4.8e-7*t*n;s=280.46645+36000.76983*t+3032e-7*n;o=(1.9146-.004817*t-14e-6*n)*Math.sin(r*i);o=o+(.019993-101e-6*t)*Math.sin(r*2*i)+29e-5*Math.sin(r*3*i);a=s+o;f=125.04-1934.136*t;u=a-.00569-.00478*Math.sin(f*r);u=u*r;u=u-PI*2*INT(u/(PI*2));return u}function getSunLongitude(e,t){return INT(SunLongitude(e-.5-t/24)/PI*12)}function parseQuery(e){var t=new Array;if(e.length<2)return t;var n=e.substring(1,e.length);var r=n.split("&");var i,s;for(i=0;i<r.length;i++){var o=r[i].split("=");for(s=0;s<o.length;s++){t.push(o[s])}}return t}function getSelectedMonth(){var e=window.location.search;var t=parseQuery(e);var n;for(n=0;n<t.length;n++){if(t[n]=="mm"){currentMonth=parseInt(t[n+1])}else if(t[n]=="yy"){currentYear=parseInt(t[n+1])}}}function getMonth(e,t){var n,r,i,s,o,u,a,f,l;if(e<12){u=e+1;a=t}else{u=1;a=t+1}s=jdn(1,e,t);o=jdn(1,u,a);n=getYearInfo(t);i=n[0].jd;f=new Array;if(i<=s){for(l=s;l<o;l++){f.push(findLunarDate(l,n))}}else if(s<i&&o<i){n=getYearInfo(t-1);for(l=s;l<o;l++){f.push(findLunarDate(l,n))}}else if(s<i&&i<=o){r=getYearInfo(t-1);for(l=s;l<i;l++){f.push(findLunarDate(l,r))}for(l=i;l<o;l++){f.push(findLunarDate(l,n))}}return f}function getDayName(e){if(e.day==0){return""}var t=getCanChi(e);var n="Ngày "+t[0]+", tháng "+t[1]+", năm "+t[2];return n}function getYearCanChi(e){return CAN[(e+6)%10]+" "+CHI[(e+8)%12]}function getCanHour0(e){return CAN[(e-1)*2%10]}function getCanChi(e){var t,n,r;t=CAN[(e.jd+9)%10]+" "+CHI[(e.jd+1)%12];n=CAN[(e.year*12+e.month+3)%10]+" "+CHI[(e.month+1)%12];if(e.leap==1){n+=" (nhuận)"}r=getYearCanChi(e.year);return new Array(t,n,r)}function getDayString(e,t,n,r){var i;var s=TUAN[(e.jd+1)%7];i=s+" "+t+"/"+n+"/"+r;i+=" -+- ";i=i+"Ngày "+e.day+" tháng "+e.month;if(e.leap==1){i=i+" nhuận"}return i}function getTodayString(){var e=getDayString(currentLunarDate,today.getDate(),today.getMonth()+1,today.getFullYear());e+=" năm "+getYearCanChi(currentLunarDate.year);return e}function getCurrentTime(){today=new Date;var e=today.getHours();var t=today.getMinutes();var n=today.getSeconds();var r=e<10?"0"+e:e;var i=t<10?"0"+t:t;return r+":"+i}function getGioHoangDao(e){var t=(e+1)%12;var n=GIO_HD[t%6];var r="";var i=0;for(var s=0;s<12;s++){if(n.charAt(s)=="1"){r+=CHI[s];r+=" ("+(s*2+23)%24+"-"+(s*2+1)%24+")";if(i++<5)r+=", ";if(i==3)r+="\n"}}return r}function OutputOptions(){this.fontSize="13pt";this.tableWidth="420px"}function setOutputSize(e){var t=1;if(e=="small"){t=0}else if(e=="big"){t=2}else{t=1}PRINT_OPTS.fontSize=FONT_SIZES[t];PRINT_OPTS.tableWidth=TAB_WIDTHS[t]}function printSelectedMonth(){getSelectedMonth();return printMonth(currentMonth,currentYear)}function printMonth(e,t){var n="";n+=printStyle();n+="<div id='lich'>";n+=printTable(e,t);n+="</div>";return n}function printYear(e){var t="N&#x103;m "+getYearCanChi(e)+" "+e;var n="";n+=printStyle();n+="<table align=center>\n";n+='<tr><td colspan="3" class="tennam" onClick="showYearSelect();">'+t+"</td></tr>\n";for(var r=1;r<=12;r++){if(r%3==1)n+="<tr>\n";n+="<td>\n";n+=printTable(r,e);n+="</td>\n";if(r%3==0)n+="</tr>\n"}n+="<table>\n";n+=printFoot();return n}function printSelectedYear(){getSelectedMonth();return printYear(currentYear)}function printStyle(){var e=PRINT_OPTS.fontSize;var t="";t+='<style type="text/css">\n';t+="<!--\n";t+="  .tennam {text-align:center; font-size:150%; line-height:120%; font-weight:bold; color:#000000; background-color: #CCCCCC}\n";t+="  .thang {font-size: "+e+"; padding:1; line-height:100%; font-family:Tahoma,Verdana,Arial; table-layout:fixed}\n";t+="  .tenthang {text-align:center; font-size:125%; line-height:100%; font-weight:bold; color:#330033; background-color: #CCFFCC}\n";t+="  .navi-l {text-align:center; font-size:75%; line-height:100%; font-family:Verdana,Times New Roman,Arial; font-weight:bold; color:red; background-color: #CCFFCC;}\n";t+="  .navi-l a{float:none;padding-left:0}\n";t+="  .navi-r {text-align:center; font-size:75%; line-height:100%; font-family:Verdana,Arial,Times New Roman; font-weight:bold; color:#330033; background-color: #CCFFCC;}\n";t+="  .navi-r a{float:none;padding-left:0}\n";t+="  .ngaytuan {width:14%; text-align:center; font-size:125%; line-height:100%; color:#330033; background-color: #FFFFCC}\n";t+="  .ngaythang {background-color:#FDFDF0;border:2px solid;}\n";t+="  .ngaythang:hover {background-color:#CCFFCC;cursor:pointer;}\n";t+="  .homnay {background-color:#FFF000}\n";t+="  .tet {background-color:#FFCC99}\n";t+="  .am {text-align:right;font-size:75%;line-height:100%;color:blue}\n";t+="  .am2 {text-align:right;font-size:75%;line-height:100%;color:#004080}\n";t+="  .t2t6 {text-align:left;font-size:125%;color:black}\n";t+="  .t7 {text-align:left;font-size:125%;line-height:100%;color:green}\n";t+="  .cn {text-align:left;font-size:125%;line-height:100%;color:red}\n";t+="-->\n";t+="</style>\n";return t}function printTable(e,t){var n,r,i,s,o,u,a,f;var l=getMonth(e,t);if(l.length==0)return;var c=l[0];var h=(c.jd+1)%7;var p=e+"/"+t;var d=getYearCanChi(c.year);var v="";v+='<table class="thang" style="background-color:#7C99AA;" cellpadding="1" cellspacing="1" width="'+PRINT_OPTS.tableWidth+'">\n';v+=printHead(e,t);for(n=0;n<6;n++){v+="<tr>\n";for(r=0;r<7;r++){i=7*n+r;if(i<h||i>=h+l.length){v+=printEmptyCell()}else{s=i-h+1;c=l[i-h];v+=printCell(c,s,e,t)}}v+="</tr>\n"}v+="</table>\n";return v}function goToMonth(e,t){document.getElementById("lich").innerHTML=printTable(e,t)}function getPrevMonthLink(e,t){var n=e>1?e-1:12;var r=e>1?t:t-1;return'<a href="javascript:void(0)" onclick="goToMonth('+n+", "+r+')"><</a>'}function getNextMonthLink(e,t){var n=e<12?e+1:1;var r=e<12?t:t+1;return'<a href="javascript:void(0)" onclick="goToMonth('+n+", "+r+')">></a>'}function getPrevYearLink(e,t){return'<a href="javascript:void(0)" onclick="goToMonth('+e+", "+(t-1)+')"><<</a>'}function getNextYearLink(e,t){return'<a href="javascript:void(0)" onclick="goToMonth('+e+", "+(t+1)+')">>></a>'}function printHead(e,t){var n="";var r=e+"/"+t;n+='<tr><td colspan="1" class="navi-l" title="Nam tru?c">'+getPrevYearLink(e,t)+"</td>\n";n+='<td colspan="1" class="navi-l" title="Tháng tru?c">'+getPrevMonthLink(e,t)+"</td>\n";n+='<td colspan="3" class="tenthang" onClick="showMonthSelect();">'+r+"</td>\n";n+='<td colspan="1" class="navi-r" title="Tháng sau">'+getNextMonthLink(e,t)+"</td>\n";n+='<td colspan="1" class="navi-r" title="Nam sau">'+getNextYearLink(e,t)+"</td></tr>\n";n+='<tr onClick="alertAbout();">\n';for(var i=0;i<=6;i++){if(DAYNAMES[i]=="CN"){n+='<td class=ngaytuan style="color:red">'+DAYNAMES[i]+"</td>\n"}else{n+="<td class=ngaytuan>"+DAYNAMES[i]+"</td>\n"}}n+="</tr>\n";return n}function printEmptyCell(){return"<td class=ngaythang><div class=cn>&nbsp;</div> <div class=am>&nbsp;</div></td>\n"}function printCell(e,t,n,r){var i,s,o,u;i="ngaythang";s="t2t6";o="am";u="black";var a=(e.jd+1)%7;if(a==0){s="cn";u="red"}else if(a==6){s="t7";u="green"}if(t==today.getDate()&&n==today.getMonth()+1&&r==today.getFullYear()){i="homnay"}if(e.day==1&&e.month==1){i="tet"}if(e.leap==1){o="am2"}var f=e.day;if(t==1||f==1){f=e.day+"/"+e.month}var l="";var c=e.day+","+e.month+","+e.year+","+e.leap;c+=","+e.jd+","+t+","+n+","+r;l+='<td class="'+i+'"';if(e!=null)l+=' title="'+getDayName(e)+'" onClick="alertDayInfo('+c+');"';l+=" <div style=color:"+u+' class="'+s+'">'+t+'</div> <div class="'+o+'">'+f+"</div></td>\n";return l}function alertDayInfo(e,t,n,r,i,s,o,u){var a=new LunarDate(e,t,n,r,i);var f=getDayString(a,s,o,u);f+=" âm lịch\n";f+=getDayName(a);f+="\nGiờ đầu ngày: "+getCanHour0(i)+" "+CHI[0];f+="\nTiết: "+TIETKHI[getSunLongitude(i+1,7)];f+="\nGiờ hoàng đạo: "+getGioHoangDao(i);alert(f)}function showVietCal(){window.status=getCurrentTime()+" -+- "+getTodayString();window.window.setTimeout("showVietCal()",5e3)}function alertAbout(){alert(ABOUT)}function showMonthSelect(){}var ABOUT="Version 0.8";var TK19=new Array(3193507,5679952,4336544,2927457,5415792,3953128,6345056,4908208,3631398,5823136,4479824,3217106,5647072,4104928,2679506,5163344,3724630,6075680,4634256,3300772,5789136,4335056,2926003,5415600,4040887,6334800,4895904,3519141,5942608,4478384,3156852,5645680,4215545,6574768,5138768,3698006,6183584,4631376,3299028,5786336,4367728,2966867,5296800,3926183,6346064,4872864,3452325,5936592,4606688,3058356,5547216,4117176,6599312,5027152,3692375,6172064,4756944,3296629,5786032,4367536,2991283,5270160,3845528,6318928,4991840,3511141,5935984,4606320,3172708,5432480,3992170,6478480,5135056,3746518,6171360,4756192,3328725,5687632,4248736,2872483,5289616,3823527,6313392,4990416,3577269,5935792,4499792,3070292,5551264,3978576,2648914,5133744,3811190,6169968,4739760,3320485,5695824,4221600,2800291,5286736);var TK20=new Array(3951576,6441696,5023088,3691733,6083168,4512080,3233108,5658272,4233936,2774482,5262048,3843510,6333648,4772432,3396181,5813568,4380320,2928034,5412272,4147575,6572400,5022896,3585205,6056528,4615504,3222356,5647200,4232560,2904818,5261680,3827046,6214816,4778576,3369621,5790416,4467552,3114723,5411552,4049111,6474064,5035168,3528870,5944656,4609696,3253684,5645776,4231888,2806450,5286224,3716439,6188192,4765008,3494741,5787040,4367792,3097971,5526192,3975592,6351184,5008032,3583654,5942096,4606816,3189476,5678448,4215392,2683491,5167424,3726151,6084256,4757200,3427797,5917392,4367568,2938036,5419600,3986776,6337856,4896160,3626406,6067632,4606384,3189108,5678256,4237904,2730578,5139744,3779911,6204256,4756336,3427061,5917040,4482224,2913443,5302864,4024920,6444704,4893392,3577557,6066912);var TK21=new Array(4639072,3070292,5559456,4119120,2782546,5133984,3712935,6202832,4887216,3320501,5810512,4371616,2931364,5287248,3954137,6441888,5023152,3625334,6050416,4614448,3176756,5532320,4107600,2775890,5262176,3712742,6202592,4772448,3336805,5690656,4250272,2971299,5396176,3951355,6441424,5022928,3657910,5943888,4502816,3071269,5551520,4085200,2774450,5261744,3843447,6202544,4762192,3387989,5795104,4238688,2968419,5395312,4082152,6343024,5002416,3631270,5954128,4479648,3122852,5548752,4215520,2675427,5163344,3724631,6214816,4643152,3300693,5789344,4368080,2905556,5395120,3975608,6465840,4895888,3454630,5942608,4609440,3058532,5547376,4215472,2797939,5138736,3697463,6187680,4762960,3353301,5778272,4367728,3035876,5296480,3860824,6346016,4905616,3496614,5920464,4598496,3189204,5546704,4116816,2681170);var TK22=new Array(5158176,3725095,6204832,4871600,3550645,5916080,4498096,3060404,5548368,3978585,6449952,5025104,3692390,6050672,4736368,3302772,5788336,4221264,2783571,5266080,3910311,6203088,4868832,3515109,5940560,4379296,3007140,5428560,4086459,6444704,5019344,3754422,6179504,4630736,3200181,5681808,4240720,2780498,5262752,3904871,6329712,4868528,3451253,5924016,4483728,2931348,5401424,4074336,2665313,5018992,3689190,6082912,4646048,3075365,5560976,4217680,2897619,5253856,3838935,6329040,4901200,3331414,5813408,4372112,3038612,5395888,4072954,6563248,5149360,3582646,6056272,4617376,3256997,5549392,4216224,2796403,5383536,3822455,6312624,4876624,3435862,5790368,4369232,3036884,5524192,3974512,2647250,5034592,3599014,5952848,4610720,3190181,5674448,4213456,2795955,5285072,3855031,6206032,4764992,3396950);var CAN=new Array("Giáp","Ất","Bính","Đinh","Mậu","Kỷ","Canh","Tân","Nhâm","Quý");var CHI=new Array("Tý","Sửu","Dần","Mão","Thìn","Tỵ","Ngọ","Mùi","Thân","Dậu","Tuất","Hợi");var TUAN=new Array("Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy");var GIO_HD=new Array("110100101100","001101001011","110011010010","101100110100","001011001101","010010110011");var TIETKHI=new Array("Xuân phân","Thanh minh","Cốc vũ","Lập hạ","Tiểu mãn","Mang chủng","Hạ chí","Tiểu thử","Đại thử","Lập thu","Xử thử","Bạch lộ","Thu phân","Hàn lộ","Sương giáng","Lập đông","Tiểu tuyết","Đại tuyết","Đông chí","Tiểu hàn","Đại hàn","Lập xuân","Vũ Thủy","Kinh trập");var PI=Math.PI;var FIRST_DAY=jdn(25,1,1800);var LAST_DAY=jdn(31,12,2199);var today=new Date;var currentLunarDate=getLunarDate(today.getDate(),today.getMonth()+1,today.getFullYear());var currentMonth=today.getMonth()+1;var currentYear=today.getFullYear();var DAYNAMES=new Array("CN","T2","T3","T4","T5","T6","T7");var PRINT_OPTS=new OutputOptions;var FONT_SIZES=new Array("9pt","13pt","17pt");var TAB_WIDTHS=new Array("100%","420px","600px");
